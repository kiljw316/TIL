# WebRTC P2P 방식 선택 시 클라이언트의 부하

## WebRTC 연결 방법
### 종류
연결 방법 종류는 P2P, SFU, MCU 방식이 있는데 이 중 SFU, MCU 방식은 서버의 자원을 사용하여 미디어 연결을 도와주지만 P2P 방식만 클라이언트의 자원을 사용한다.

## P2P 방식을 사용하는 이유

### 서버의 부하
서버의 부하가 적다. 기본적으로 클라이언트의 자원을 사용하기 때문에 초기 peer connection 부분만을 서버가 담당하고 이후 비디오, 오디오 데이터 등을 클라이언트 끼리 송수신을 하게 된다. 

### 실시간성
서버같은 중개자가 없이 데이터를 송수신하기 때문에 실시간성이 보장된다.

## P2P 연결 방식의 단점
P2P 연결이라 1대1 연결만 가능하다고 생각할 수 있지만 여러 peer들 끼리 연결도 가능하다. 하지만 peer 연결의 수가 증가할 수록 클라이언트의 부하는 급속도로 증가하게 된다.

## 부하 증가의 원인
<br>

![image](https://user-images.githubusercontent.com/87928719/151275389-d9dd0792-2ac7-40c2-9816-c3fc515b7ef7.png)[이미지 출처](https://www.pinterest.co.kr/pin/715227984559170734/)

위 사진의 예처럼 각 peer는 모든 피어와 직접적으로 연결되어 있는 Mesh 형태로 되어 있다. 예를 들어 peer가 5명이라고 한다면 
- peer 당 커넥션 수 = 4 (peer 마다 연결되어 있는 링크 수 )
- 모든 peer 커넥션 수 = 10 (5개의 peer 가 연결되어 있는 링크 수)
- download, upload 시 커넥션 되어 있는 peer 의 수만큼 반복 전송해야 되기 때문에 높은 부하를 요구하고 비효율적이게 된다.
- 기본적인 서버 클라이언트 통신에서 보다 peer 수 만큼 배수로 들어간다.

## 결론
따라서 P2P 방식으로 2명 초과로 peer 연결을 할 경우 peer 의 컴퓨터 성능에 따른 peer 연결 수 를 제한하는 제약조건이 필요하다.


